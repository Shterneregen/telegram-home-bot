plugins {
    id "org.springframework.boot" version "2.5.2"
    id "io.spring.dependency-management" version "1.0.11.RELEASE"
    id "java"
    id "org.jetbrains.kotlin.jvm" version "1.5.20"
    id "org.jetbrains.kotlin.plugin.spring" version "1.5.20"
    id "org.jetbrains.kotlin.plugin.jpa" version "1.5.20"
}

ext {
    telegrambotsSpringBootStarterVersion = "5.3.0"
    thymeleafExtrasSpringsecurity5Version = "3.0.4.RELEASE"
    opencsvVersion = "5.3"
    commonsLang3Version = "3.11"
    emojiJavaVersion = "5.1.1"
}

sourceSets {
    main.kotlin.srcDirs += "src/main/java"
}

group = "random"
version = "0.0.1-SNAPSHOT"
sourceCompatibility = "11"

configurations {
    compileOnly {
        extendsFrom annotationProcessor
    }
}

repositories {
    mavenCentral()
}

dependencies {
    implementation(
            "org.springframework.boot:spring-boot-starter-actuator",
            "org.springframework.boot:spring-boot-starter-web",
            "org.springframework.boot:spring-boot-starter-data-jpa",
            "org.springframework.boot:spring-boot-starter-thymeleaf",
            "org.springframework.boot:spring-boot-starter-security",
            "org.springframework.boot:spring-boot-starter-validation",
            "nz.net.ultraq.thymeleaf:thymeleaf-layout-dialect",
            "org.thymeleaf.extras:thymeleaf-extras-springsecurity5:$thymeleafExtrasSpringsecurity5Version",
            "org.telegram:telegrambots-spring-boot-starter:$telegrambotsSpringBootStarterVersion",
            "com.opencsv:opencsv:$opencsvVersion",
            "org.apache.commons:commons-lang3:$commonsLang3Version",
            "com.vdurmont:emoji-java:$emojiJavaVersion",
            "org.passay:passay:1.6.0"
    )
    compileOnly "org.projectlombok:lombok"
    developmentOnly "org.springframework.boot:spring-boot-devtools"
    runtimeOnly "com.h2database:h2"
    annotationProcessor(
            "org.springframework.boot:spring-boot-configuration-processor",
            "org.projectlombok:lombok"
    )
    testImplementation(
            "org.springframework.boot:spring-boot-starter-test",
            "org.springframework.security:spring-security-test"
    )

    runtimeOnly "org.jetbrains.kotlin:kotlin-reflect:1.5.20"
    implementation(
            "org.jetbrains.kotlin:kotlin-stdlib-jdk8",
            "com.fasterxml.jackson.module:jackson-module-kotlin:2.12.4"
    )
}

test {
    useJUnitPlatform()
}

bootJar {
    archiveFileName = "thb.jar"
    launchScript()
}
compileKotlin {
    kotlinOptions {
        jvmTarget = "11"
    }
}
compileTestKotlin {
    kotlinOptions {
        jvmTarget = "11"
    }
}
